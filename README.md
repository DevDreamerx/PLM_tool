# 技术状态管理助手 V1.0 - 使用说明

## 项目简介
技术状态管理助手是一款运行于 Windows 7 平台的桌面应用程序，用于管理产品技术状态信息，支持数据录入、查询、统计分析和导出功能。

## 功能特性
- ✅ **完整数据录入**: 支持产品基本信息、技术状态、变更信息的全字段录入
- ✅ **草稿/正式提交**: 区分草稿和正式记录，灵活的数据管理
- ✅ **智能查询**: 模糊搜索、详情查看、数据删除
- ✅ **变更追溯**: 完整的变更历史时间线，支持审计追踪
- ✅ **数据分析**: 统计卡片、可视化图表展示产品分布
- ✅ **Excel 导出**: 一键导出完整数据到 Excel 格式
- ✅ **自动备份**: 程序退出时自动备份数据库，支持手动恢复
- ✅ **系统设置**: 可配置备份策略和路径

## 环境要求
- **操作系统**: Windows 7 SP1 及以上 / macOS / Linux
- **Python 版本**: Python 3.8+
- **依赖库**: 见 requirements.txt

## 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 运行程序 (开发模式)
```bash
python main.py
```

首次运行会自动在当前目录生成 `tsm_data.db` 数据库文件和 `config.json` 配置文件。

## Windows 7 打包部署

### 在 Windows 7 环境下打包
```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 打包为单文件 exe
pyinstaller --onefile --windowed --name "TechStatusManager" main.py

# 3. 生成的文件位于 dist 目录
# dist/TechStatusManager.exe
```

### 打包注意事项
- 确保在 Windows 7 环境下打包，以保证兼容性
- 使用 Python 3.8.x 版本（Windows 7 支持的最后一个版本）
- 打包后的 exe 文件可直接在目标机器运行，无需安装 Python

## 使用指南

### 状态录入
1. 点击左侧导航栏"📝 状态录入"
2. 填写产品基本信息（产品代号、名称、批次、型号）
3. 填写技术状态信息（图号、版本、软件/固件版本等）
4. 填写变更信息（可选）
5. 点击"暂存草稿"保存草稿，或"正式提交"保存正式记录

### 状态查询
1. 点击左侧导航栏"🔍 状态查询"
2. 输入关键词搜索（支持产品代号、名称模糊匹配）
3. 点击"查看"按钮查看详情和变更历史
4. 点击"删除"按钮删除记录（软删除）

### 数据报表
1. 点击左侧导航栏"📊 数据报表"
2. 查看统计卡片（总记录数、正式记录、草稿数）
3. 查看产品型号分布图表
4. 点击"导出全部数据"导出 Excel 文件

### 系统设置
1. 点击左侧导航栏"⚙️ 系统设置"
2. 配置自动备份开关和备份目录
3. 设置备份保留天数
4. 点击"立即备份"手动创建备份
5. 点击"恢复备份"从备份文件恢复数据

## 数据备份与恢复

### 自动备份
- 程序退出时自动备份数据库到 `./backups/` 目录
- 备份文件命名格式: `tsm_data_backup_YYYYMMDD_HHMMSS.db`
- 自动清理超过保留天数的旧备份

### 手动备份
- 在系统设置页面点击"立即备份"
- 备份文件保存到配置的备份目录

### 恢复数据
- 在系统设置页面点击"恢复备份"
- 选择备份文件
- 确认后覆盖当前数据库
- **重要**: 恢复后需重启程序

## 常见问题

### Q: 程序无法启动？
A: 检查是否安装了所有依赖库，运行 `pip install -r requirements.txt`

### Q: 图表不显示？
A: 确保已安装 matplotlib: `pip install matplotlib`

### Q: 如何迁移数据到其他机器？
A: 复制 `tsm_data.db` 文件到新机器的程序目录即可

### Q: 备份文件在哪里？
A: 默认在程序目录的 `./backups/` 文件夹，可在系统设置中修改

## 技术支持
如有问题，请查看项目文档或联系技术支持。

## 版本信息
- **当前版本**: V1.0
- **发布日期**: 2026-01-20
- **开发框架**: Python 3.8 + PyQt5 + SQLite
